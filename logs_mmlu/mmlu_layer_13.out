>>> Starting MMLU ablation for layer 13
>>> Model:        /lustre06/project/6067888/thwang4/bagel/BAGEL/models/BAGEL-7B-MoT
>>> Output dir:   /lustre06/project/6067888/thwang4/bagel/BAGEL/results_mmlu
>>> Subjects:     high_school_mathematics,high_school_physics,college_mathematics,abstract_algebra,computer_security,formal_logic
>>> Max Q / subj: 100
>>> HF_CACHE_DIR: /lustre06/project/6067888/thwang4/bagel/hf_mmlu
>>> ABLATE_LAYER = 13
>>> MODEL_PATH   = /lustre06/project/6067888/thwang4/bagel/BAGEL/models/BAGEL-7B-MoT
>>> Loading BAGEL model with eval.vlm.utils.load_model_and_tokenizer...

=== Evaluating subject: high_school_mathematics ===
[ZeroAblation] Zeroed attention + MLP weights for layer 13
[high_school_mathematics] 20/100 — acc = 0.300
[high_school_mathematics] 40/100 — acc = 0.400
[high_school_mathematics] 60/100 — acc = 0.400
[high_school_mathematics] 80/100 — acc = 0.412
[high_school_mathematics] 100/100 — acc = 0.440
Subject high_school_mathematics: 44.00% (44/100)

=== Evaluating subject: high_school_physics ===
[high_school_physics] 20/100 — acc = 0.100
[high_school_physics] 40/100 — acc = 0.150
[high_school_physics] 60/100 — acc = 0.233
[high_school_physics] 80/100 — acc = 0.263
[high_school_physics] 100/100 — acc = 0.230
Subject high_school_physics: 23.00% (23/100)

=== Evaluating subject: college_mathematics ===
[college_mathematics] 20/100 — acc = 0.350
[college_mathematics] 40/100 — acc = 0.400
[college_mathematics] 60/100 — acc = 0.417
[college_mathematics] 80/100 — acc = 0.412
[college_mathematics] 100/100 — acc = 0.370
Subject college_mathematics: 37.00% (37/100)

=== Evaluating subject: abstract_algebra ===
[abstract_algebra] 20/100 — acc = 0.300
[abstract_algebra] 40/100 — acc = 0.325
[abstract_algebra] 60/100 — acc = 0.317
[abstract_algebra] 80/100 — acc = 0.300
[abstract_algebra] 100/100 — acc = 0.290
Subject abstract_algebra: 29.00% (29/100)

=== Evaluating subject: computer_security ===
[computer_security] 20/100 — acc = 0.500
[computer_security] 40/100 — acc = 0.425
[computer_security] 60/100 — acc = 0.417
[computer_security] 80/100 — acc = 0.400
[computer_security] 100/100 — acc = 0.380
Subject computer_security: 38.00% (38/100)

=== Evaluating subject: formal_logic ===
[formal_logic] 20/100 — acc = 0.150
[formal_logic] 40/100 — acc = 0.175
[formal_logic] 60/100 — acc = 0.217
[formal_logic] 80/100 — acc = 0.237
[formal_logic] 100/100 — acc = 0.270
Subject formal_logic: 27.00% (27/100)

=== DONE ===
Overall accuracy: 33.00% (198/600)
Saved results to: /lustre06/project/6067888/thwang4/bagel/BAGEL/results_mmlu/mmlu_layer_13.json
